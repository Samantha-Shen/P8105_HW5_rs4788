P8105_HW5_rs4788
================

# Problem 1

### First, creat a function

``` r
duplicate_birth = 
  function(n, days = 365) {
  if (!is.numeric(n) || length(n) != 1 || n <= 0 || n != as.integer(n)) {
    stop
  }
  if (!is.numeric(days) || length(days) != 1 || days <= 1 || days != as.integer(days)) {
    stop
  }
  
  bdays = sample.int(days, size = n, replace = TRUE)
  any(duplicated(bdays))
}
```

### Then, make a plot

``` r
set.seed(8105)
ns = 2:50
B  = 10000

prob =
  tibble(n = ns) %>%
  mutate(p_shared = purrr::map_dbl(n, ~ mean(replicate(B, duplicate_birth(.x)))))

prob
```

    ## # A tibble: 49 × 2
    ##        n p_shared
    ##    <int>    <dbl>
    ##  1     2   0.0024
    ##  2     3   0.007 
    ##  3     4   0.0173
    ##  4     5   0.0258
    ##  5     6   0.0378
    ##  6     7   0.0539
    ##  7     8   0.0755
    ##  8     9   0.0925
    ##  9    10   0.121 
    ## 10    11   0.138 
    ## # ℹ 39 more rows

``` r
ggplot(prob, aes(x = n, y = p_shared)) +
  geom_line(linewidth = 0.5, color = "#0072B2") +
  geom_point(size = 1.2, color = "#0072B2", alpha = 0.85) +
  geom_hline(yintercept = 0.5, linetype = "dashed") +
  scale_y_continuous(labels = percent_format(accuracy = 1)) +
  labs(
    title = "Probability of at least two people share birthday",
    x = "Group size (n)",
    y = "Probability"
  ) +
  theme_minimal()
```

<img src="P8105_HW5_rs4788_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

The probability that at least two people in the group share a birthday
by averaging across the 10000 simulation increases rapidly with the
group size n. When n is approximately 23, the probability reaches 50%,
and when n is 50, the probability has already reached approximately 95%.
